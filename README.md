## Disclaimer

*This README was generated by Claude Opus 4.1 (claude-opus-4-1-20250805)*

# GitHub Stats Updater

A Rust-based tool that analyzes your GitHub contributions across all repositories and generates comprehensive statistics, tracking actual code changes with language-specific breakdowns.

## Features

- **Comprehensive Repository Analysis**: Scans all accessible GitHub repositories (owned and forked)
- **Language-Specific Statistics**: Tracks lines of code by programming language
- **Incremental Updates**: Efficiently processes only new commits since last scan
- **Persistent Storage**: Uses SQLite database for historical data tracking
- **Blacklist Management**: Exclude specific commits from statistics
- **Activity Visualizations**: Generates charts showing coding activity over time
- **Automated README Updates**: Can automatically update a GitHub repository's README with stats

## Installation

### Prerequisites

- Rust 1.70+ (install via [rustup](https://rustup.rs/))
- Git
- GitHub Personal Access Tokens (PATs)

### Building from Source

```bash
git clone https://github.com/yourusername/github-stats-updater.git
cd github-stats-updater
cargo build --release
```

The binary will be available at `./target/release/github-stats-updater`

## Configuration

### GitHub Tokens

You'll need two GitHub Personal Access Tokens:

1. **Read Token** (`PAT_READ`): For accessing repository data
   - Required scope: `repo:read` or `public_repo`
   
2. **Write Token** (`PAT_WRITE`): For updating the README repository (optional)
   - Required scope: `repo` (full control of the target repository)

### Environment Variables

Create a `.env` file in the project root:

```bash
cp .env.example .env
```

Edit `.env` and add your tokens:

```env
PAT_READ=ghp_your_read_token_here
PAT_WRITE=ghp_your_write_token_here
USER_EMAILS=alternate@email.com,work@email.com  # Optional
```

## Usage

### Basic Command

```bash
# Analyze repositories and display statistics
github-stats-updater --username YOUR_GITHUB_USERNAME

# Analyze and update a README repository
github-stats-updater --username YOUR_GITHUB_USERNAME --repo-name YOUR_REPO_NAME
```

### Command-Line Options

```
Options:
  --username <USERNAME>           GitHub username (required)
  --repo-name <REPO_NAME>        Repository to update with stats
  --readme-path <PATH>           Path to README file [default: README.md]
  --db-url <URL>                 SQLite database URL [default: sqlite:github_stats.db]
  --force-rescan                 Force full rescan of all repositories
  --recreate-only               Only recreate output from existing database
  --only-repo <REPO>            Process only specific repository
  --user-emails <EMAILS>        Additional emails to track (comma-separated)
  --log-level <LEVEL>           Set log level (trace/debug/info/warn/error)
  
Blacklist Management:
  --blacklist-show              Show current blacklist
  --blacklist-add <HASHES>      Add commit hashes to blacklist
  --blacklist-remove <HASHES>   Remove commit hashes from blacklist
  --blacklist-file <FILE>       Blacklist JSON file [default: blacklist.json]
```

### Examples

```bash
# Basic scan with console output
github-stats-updater --username burck

# Update a GitHub profile README
github-stats-updater --username burck --repo-name burck

# Process only a specific repository
github-stats-updater --username burck --only-repo my-project

# Force complete rescan
github-stats-updater --username burck --force-rescan

# Manage blacklist
github-stats-updater --blacklist-show
github-stats-updater --blacklist-add abc123,def456
github-stats-updater --blacklist-remove abc123
```

## Output

The tool generates detailed statistics including:

- **Overall Statistics**: Total commits, lines added/removed, net lines
- **Language Breakdown**: Statistics per programming language
- **Activity Visualizations**:
  - Monthly code activity charts
  - Language activity comparison with bar charts
  - Weekly net lines trend graphs

### Sample Output

```
ðŸ“Š GitHub Contribution Statistics
==================================================
*Based on actual commits across all repositories (including forks)*

ðŸ“ˆ Overall Statistics
----------------------
â€¢ Total Commits:        1,234
â€¢ Lines Added:      123,456
â€¢ Lines Removed:     45,678
â€¢ Net Lines:         77,778

ðŸ’» Language Breakdown
----------------------
Language         Net Lines        Added      Removed  Commits
Rust                45,000       50,000        5,000      450
Python              20,000       25,000        5,000      300
JavaScript          12,778       15,000        2,222      484
```

## Automation

### Systemd Service (Linux)

Create service files for automated updates:

```bash
# Copy service files
sudo cp github-stats-updater.service /etc/systemd/system/
sudo cp github-stats-updater.timer /etc/systemd/system/

# Edit service file with your paths and username
sudo systemctl edit github-stats-updater.service

# Enable and start timer
sudo systemctl enable github-stats-updater.timer
sudo systemctl start github-stats-updater.timer
```

### GitHub Actions

You can also run this tool in GitHub Actions for automated updates. Create `.github/workflows/update-stats.yml`:

```yaml
name: Update GitHub Stats
on:
  schedule:
    - cron: '0 0 * * *'  # Daily at midnight
  workflow_dispatch:

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
      - run: cargo run -- --username ${{ github.repository_owner }} --repo-name ${{ github.repository_owner }}
        env:
          PAT_READ: ${{ secrets.PAT_READ }}
          PAT_WRITE: ${{ secrets.PAT_WRITE }}
```

## Database Schema

The tool uses SQLite with the following main tables:

- `commits`: Stores commit metadata and statistics
- `commit_languages`: Language-specific statistics per commit
- `last_processed`: Tracks last processed commit for incremental updates
- `commit_blacklist`: Excluded commits

## Troubleshooting

### Common Issues

1. **Authentication Errors**: Ensure your PAT tokens have the correct scopes
2. **Empty Repository Errors**: Normal for repositories without commits
3. **Rate Limiting**: The tool respects GitHub API rate limits
4. **Large Repositories**: Initial scan may take time; subsequent runs are incremental

### Debug Mode

Enable detailed logging:

```bash
github-stats-updater --username YOUR_USERNAME --log-level debug
```

Or set environment variable:

```bash
RUST_LOG=debug github-stats-updater --username YOUR_USERNAME
```

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the MIT License - see the LICENSE file for details.

